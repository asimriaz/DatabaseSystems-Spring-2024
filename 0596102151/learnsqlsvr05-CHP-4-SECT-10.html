<html>
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<head>
<title>Section 4.10.&nbsp; Exercises</title>
<link rel="STYLESHEET" type="text/css" href="images/style.css">
<link rel="STYLESHEET" type="text/css" href="images/docsafari.css">
</head>
<body>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr><td><div STYLE="MARGIN-LEFT: 0.15in;">
<a href=learnsqlsvr05-CHP-4-SECT-9.html><img src="images/prev.gif" width="60" height="17" border="0" align="absmiddle" alt="Previous Page"></a>
<td align="right"><div STYLE="MARGIN-LEFT: 0.15in;">
<a href=learnsqlsvr05-CHP-5.html><img src="images/next.gif" width="60" height="17" border="0" align="absmiddle" alt="Next Page"></a>
</div></td></tr></table>
<br><table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><TD valign="top"><a name="learnsqlsvr05-CHP-4-SECT-10"></a>
<H3 id="588026-827" class="docSection1Title">4.10. Exercises</H3>
<p class="docText">Unless specified otherwise, use the <tt>Student_course</tt> database to answer the following questions. Also, use appropriate column headings when displaying your output.</P>
<div style="font-weight:bold"><ol class="docList" type="1"><LI><div style="font-weight:normal"><p class="docList">Create two tables, <tt>Stu</tt>(<tt>name</tt>, <tt>majorCode</tt>) and <tt>Major</tt>(<tt>majorCode</tt>, <tt>majorDesc</tt>), with the following data. Use <tt>VARCHAR</tt> for the codes and appropriate data types for the other columns.</p><p><table cellspacing="0" border="1" RULES="all" cellpadding="4" width="90%"><colgroup span="2"><col><col></colgroup><thead><tr><th class="thead" scope="col" align="left"><p class="docText"><tt>Stu</tt></P></th><th class="thead" scope="col">&nbsp;</th></TR><TR><th class="thead" scope="col" align="left"><p class="docText"><tt>name</tt></P></th><th class="thead" scope="col" align="left"><p class="docText"><tt>majorCode</tt></P></th></tr></thead><TR><td class="docTableCell" align="left"><p class="docText"><tt>Jones</tt></p></TD><TD class="docTableCell" align="left"><p class="docText"><tt>CS</tt></p></td></tr><tr><TD class="docTableCell" align="left"><p class="docText"><tt>Smith</tt></p></td><td class="docTableCell" align="left"><p class="docText"><tt>AC</tt></p></TD></TR><tr><td class="docTableCell" align="left"><p class="docText"><tt>Evans</tt></p></td><td class="docTableCell" align="left"><p class="docText"><tt>MA</tt></p></td></tr><tr><td class="docTableCell" align="left"><p class="docText"><tt>Adams</tt></p></td><td class="docTableCell" align="left"><p class="docText"><tt>CS</tt></p></TD></tr><tr><td class="docTableCell" align="left"><p class="docText"><tt>Sumon</tt></P></TD><TD class="docTableCell" align="left"><p class="docText"><tt>&nbsp;</tt></P></TD></tr></table></p><br><P><table cellspacing="0" border="1" RULES="all" cellpadding="4" width="90%"><colgroup span="2"><col><col></colgroup><thead><TR><th class="thead" scope="col" align="left"><p class="docText"><tt>Major</tt></P></th><th class="thead" scope="col">&nbsp;</th></TR><TR><th class="thead" scope="col" align="left"><p class="docText"><tt>majorCode</tt></p></th><th class="thead" scope="col" align="left"><p class="docText"><tt>majorDesc</tt></P></th></tr></thead><tr><TD class="docTableCell" align="left"><p class="docText"><tt>AC</tt></P></td><td class="docTableCell" align="left"><p class="docText"><tt>Accounting</tt></p></td></TR><tr><td class="docTableCell" align="left"><p class="docText"><tt>CS</tt></p></td><TD class="docTableCell" align="left"><p class="docText"><tt>Computer Science</tt></P></td></tr><tr><td class="docTableCell" align="left"><p class="docText"><tt>MA</tt></p></td><td class="docTableCell" align="left"><p class="docText"><tt>Math</tt></p></td></tr><tr><td class="docTableCell" align="left"><p class="docText"><tt>HI</tt></p></td><TD class="docTableCell" align="left"><p class="docText"><tt>History</tt></p></td></tr></table></P><BR><div style="font-weight:bold"><ol class="docList" type="a"><LI><div style="font-weight:normal"><p class="docList">Display the Cartesian product (no <tt>WHERE</tt> clause) of the two tables. Use <tt>SELECT *...</tt>. How many rows did you get? How many rows will you always get when combining two tables with <span class="docEmphasis">n</span> and <span class="docEmphasis">m</span> rows in them (Cartesian product)?</P></div></LI><li><div style="font-weight:normal"><p class="docList">Display an equi-join of the <tt>Stu</tt> and <tt>Major</tt> tables on <tt>majorCode</tt>. First do this using the <tt>INNER JOIN</tt>, and then display the results using the equi-join with an appropriate <tt>WHERE</tt> clause. Use appropriate table aliases. How many rows did you get?</p></div></li><LI><div style="font-weight:normal"><p class="docList">Display whatever you get if you leave off the column qualifiers (the aliases) on the equi-join in question 1b. (Note: This will give an error because of ambiguous column names.)</P></div></LI><LI><div style="font-weight:normal"><p class="docList">Use the <tt>COUNT(*)</tt> function instead of <tt>SELECT *</tt> in the query. Use <tt>COUNT</tt> to show the number of rows in the result set of the equi-join.</P></div></li><LI><div style="font-weight:normal"><p class="docList">Display the <tt>name</tt>, <tt>majorCode</tt>, and <tt>majorDesc</tt> of all students regardless of whether or not they have a declared major (even if the major column is null). (Hint: You need to use a <tt>LEFT OUTER JOIN</tt> here if <tt>Stu</tt> is the first table in your equi-join query.)</p></div></li><LI><div style="font-weight:normal"><p class="docList">Display a list of <tt>majorDescs</tt> available (even if the <tt>majorDesc</tt> does not have students yet) and the students in each of the majors. (Hint: You need to use a <tt>RIGHT OUTER JOIN</tt> here.)</P></div></li><li><div style="font-weight:normal"><p class="docList">Display the Cartesian product of the two tables using a <tt>CROSS JOIN</tt>.</p></div></li></ol></div></div></LI><li><div style="font-weight:normal"><p class="docList">Create two tables, <tt>T1</tt>(<tt>name</tt>, <tt>jobno</tt>) and <tt>T2</tt>(<tt>jobno</tt>, <tt>jobdesc</tt>). Let <tt>jobno</tt> be data type <tt>INT</tt>, and use appropriate data types for the other columns. Put three rows in <tt>T1</tt> and two rows in <tt>T2</tt>. Give <tt>T1.jobno</tt> values 1, 2, 3 for the three rows: &lt;..., 1&gt;,&lt;..., 2,&gt;,&lt;..., 3&gt;, where <tt>...</tt> represents any value you choose. Give <tt>T2.jobno</tt> the values 1, 2: &lt;1,...&gt;,&lt;2,...&gt;.</p><div style="font-weight:bold"><ol class="docList" type="a"><li><div style="font-weight:normal"><p class="docList">How many rows are in the equi-join (on <tt>jobno</tt>) of <tt>T1</tt> and <tt>T2</tt>?</p></div></LI><LI><div style="font-weight:normal"><p class="docList">If the values of <tt>T2.jobno</tt> were &lt;2,...&gt;, &lt;2,...&gt; (with different <tt>jobdesc</tt> values), how many rows would you expect to get, and why? Why would the rows have to have different descriptions?</p></div></li><li><div style="font-weight:normal"><p class="docList">If the values of <tt>T2.jobno</tt> were 4, 5 as in &lt;4,...&gt;,&lt;5,...&gt;, how many rows would you expect to get?</p></div></li><li><div style="font-weight:normal"><p class="docList">If the values of <tt>T1.jobno</tt> were &lt;..., 1&gt;,&lt;..., 1&gt;,&lt;..., 1&gt; (with different names) and the values of <tt>T2.jobno</tt> were &lt;1,...&gt;,&lt;1...&gt; with different descriptions, how many rows would you expect to get?</p></div></li><li><div style="font-weight:normal"><p class="docList">If you have two tables, what is the number of rows you may expect from an equi-join operation (and with what conditions)? A Cartesian product?</p></div></li><li><div style="font-weight:normal"><p class="docList">The number of rows in an equi-join of two tables, whose sizes are <span class="docEmphasis">m</span> and <span class="docEmphasis">n</span> rows, is from ___ to ____ depending on these conditions: _________ .</p></div></li></ol></div></div></LI><li><div style="font-weight:normal"><p class="docList">Use tables <tt>T1</tt> and <tt>T2</tt> in this exercise. Create another table called <tt>T3</tt>(<tt>jobdesc</tt>, <tt>minpay</tt>). Let <tt>minpay</tt> be of data type <tt>SMALLMONEY</tt>. Populate the table with at least one occurrence of each <tt>jobdesc</tt> from table <tt>T2</tt> plus one more <tt>jobdesc</tt> that is not in <tt>T2</tt>. Write and display the result of a triple equi-join of <tt>T1</tt>, <tt>T2</tt>, and <tt>T3</tt>. Use an appropriate comment on each of the lines of the <tt>WHERE</tt> clause on which there are equi-join conditions. (Note: You will need two equi-join conditions.)</p><div style="font-weight:bold"><ol class="docList" type="a"><li><div style="font-weight:normal"><p class="docList">How many rows did you get in the equi-join?</P></div></LI><LI><div style="font-weight:normal"><p class="docList">Use the <tt>COUNT(*)</tt> function and display the number of rows in the equi-join.</P></div></LI><li><div style="font-weight:normal"><p class="docList">How many rows would you get in this meaningless, triple Cartesian product (use <tt>COUNT(*)</tt>)?</p></div></li><LI><div style="font-weight:normal"><p class="docList">In an equi-join of <span class="docEmphasis">n</span> tables, you always have _______ _ equi-join conditions in the <tt>WHERE</tt> clause.</P><p class="docList">In the preceding three exercises, you created tables <tt>T1</tt>, <tt>T2</tt>, <tt>T3</tt>, <tt>Stu</tt>, and <tt>Major</tt>. When you have completed the three exercises, delete these tables.</P><p class="docList">Answer questions 4 through 8 by using the <tt>Student_course</tt> database.</P></div></LI></ol></div></div></li><LI><div style="font-weight:normal"><p class="docList">Display a list of course names for all of the prerequisite courses.</p></div></li><LI><div style="font-weight:normal"><p class="docList">Use a <tt>JOIN</tt> or <tt>INNER JOIN</tt> to join the <tt>Section</tt> and <tt>Course</tt> tables.</P><div style="font-weight:bold"><ol class="docList" type="a"><li><div style="font-weight:normal"><p class="docList">List the course names, instructors, the semesters and years they were teaching in.</p></div></li><li><div style="font-weight:normal"><p class="docList">List the instructor, course names, and offering departments of each of the courses the instructors were teaching.</P></div></li></ol></div></div></li><li><div style="font-weight:normal"><p class="docList">Use a <tt>LEFT OUTER JOIN</tt> to join the <tt>Section</tt> and <tt>Course</tt> tables.</p><div style="font-weight:bold"><ol class="docList" type="a"><LI><div style="font-weight:normal"><p class="docList">List the course names, instructors, and the semesters and years they were teaching in. Sort in descending order by instructors.</P></div></li><li><div style="font-weight:normal"><p class="docList">List the instructor, course names, and offering departments of each of the courses the instructors were teaching.</p></div></li></ol></div></div></li><li><div style="font-weight:normal"><p class="docList">Use a <tt>RIGHT OUTER JOIN</tt> to join the <tt>Section</tt> and <tt>Course</tt> tables.</p><div style="font-weight:bold"><ol class="docList" type="a"><li><div style="font-weight:normal"><p class="docList">For each instructor, list the name of each course they teach and the semester and year in which they teach that course.</p></div></li><li><div style="font-weight:normal"><p class="docList">For each course, list the name of the instructor and the name of the department in which it is offered.</p></div></li></ol></div></div></li><LI><div style="font-weight:normal"><p class="docList"></p><div style="font-weight:bold"><ol class="docList" type="a"><li><div style="font-weight:normal"><p class="docList">Are there any differences in the answers for questions 5, 6, and 7? Why? Explain.</p></div></LI><LI><div style="font-weight:normal"><p class="docList">Use a <tt>FULL OUTER JOIN</tt> to join the <tt>Section</tt> and <tt>Course</tt> tables. How do the results vary from the results of questions 5, 6, and 7?</P></div></LI></ol></div></div></LI><li><div style="font-weight:normal"><p class="docList">Discuss the output that the following query would produce:</p><pre>
SELECT *
FROM Course AS c, Prereq AS p
WHERE c.course_number&lt;&gt;p.course_number
</pre><br>
</div></LI><LI><div style="font-weight:normal"><p class="docList">Find all the sophomores who are more senior than other students. (Hint: Use a self-join.)</P></div></LI><LI><div style="font-weight:normal"><p class="docList">Find all the courses that have more credit hours than other courses. (Hint: Use a self-join.)</p></div></LI><li><div style="font-weight:normal"><p class="docList">Display a list of the names of all students who have dependents, the dependents name, relationship and age, ordered by the age of the dependent.</p></div></LI></ol></div>

</TD></TR></table>
<br>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr><td><div STYLE="MARGIN-LEFT: 0.15in;">
<a href=learnsqlsvr05-CHP-4-SECT-9.html><img src="images/prev.gif" width="60" height="17" border="0" align="absmiddle" alt="Previous Page"></a>
<td align="right"><div STYLE="MARGIN-LEFT: 0.15in;">
<a href=learnsqlsvr05-CHP-5.html><img src="images/next.gif" width="60" height="17" border="0" align="absmiddle" alt="Next Page"></a>
</div></td></tr></table>
</body></html>