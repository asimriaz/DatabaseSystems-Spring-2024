<html>
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<head>
<title>Section 5.9.&nbsp; Exercises</title>
<link rel="STYLESHEET" type="text/css" href="images/style.css">
<link rel="STYLESHEET" type="text/css" href="images/docsafari.css">
</head>
<body>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr><td><div STYLE="MARGIN-LEFT: 0.15in;">
<a href=learnsqlsvr05-CHP-5-SECT-8.html><img src="images/prev.gif" width="60" height="17" border="0" align="absmiddle" alt="Previous Page"></a>
<td align="right"><div STYLE="MARGIN-LEFT: 0.15in;">
<a href=learnsqlsvr05-CHP-6.html><img src="images/next.gif" width="60" height="17" border="0" align="absmiddle" alt="Next Page"></a>
</div></td></tr></table>
<br><table width="100%" border="0" cellspacing="0" cellpadding="0"><TR><td valign="top"><a name="learnsqlsvr05-CHP-5-SECT-9"></a>
<h3 id="title-IDAOHUG4" class="docSection1Title">5.9. Exercises</H3>
<p class="docText">Unless specified otherwise, use the <tt>Student_course</tt> database to answer the following questions. Also, use appropriate column headings when displaying your output.</p>
<div style="font-weight:bold"><ol class="docList" type="1"><li><div style="font-weight:normal"><p class="docList">Display the <tt>COUNT</tt> of tuples (rows) in each of the tables <tt>Grade_report</tt>, <tt>Student</tt>, and <tt>Section</tt>. How many rows would you expect in the Cartesian product of all three tables? Display the <tt>COUNT</tt> (<span class="docEmphasis">not</span> the resulting rows) of the Cartesian product of all three and verify your result (use <tt>SELECT COUNT(*) ...</tt>).</P></div></li><LI><div style="font-weight:normal"><p class="docList">Display the <tt>COUNT</tt> of <tt>section-ids</tt> from the <tt>Section</tt> table. Display the <tt>COUNT</tt> of <tt>DISTINCT section-ids</tt> from the <tt>Grade_report</tt> table. What does this information tell you? (Hint: <tt>section_id</tt> is the primary key of the <tt>Section</tt> table.)</p></div></LI><LI><div style="font-weight:normal"><p class="docList">Write, execute, and print a query to list student names and grades (just two attributes) using the table alias feature. Restrict the list to students that have either As or Bs in courses with <tt>ACCT</tt> prefixes only.</P><p class="docList">Here's how to complete this problem:</P><div style="font-weight:bold"><ol class="docList" type="a"><li><div style="font-weight:normal"><p class="docList">Get the statement to work as a <tt>COUNT</tt> of a join of the three tables, <tt>Student</tt>, <tt>Grade_report</tt>, <tt>Section</tt>. Use table aliases in the join condition. Note that a join of <I>n</I> tables requires (<i>n</I> - 1) join conditions, so here you have to have two join conditions: one to join the <tt>Student</tt> and <tt>Grade_report</tt> tables, and one to join the <tt>Grade_report</tt> and <tt>Section</tt> tables. Note the number of rows that you get (expect no more rows than is in the <tt>Grade_report</tt> table). Why do you get this result?</P></div></li><li><div style="font-weight:normal"><p class="docList">Modify the query and put the <tt>Accounting</tt> condition in the <tt>WHERE</tt> clause. Note the number of rows in the resultit should be a good bit less than in question 3a.</p></div></li><LI><div style="font-weight:normal"><p class="docList">Again, modify the query and add the grade constraints. The number of rows should decrease again. Note that if you have <tt>WHERE</tt> x <span class="docEmphasis">and</span> y <span class="docEmphasis">or</span> z, parentheses are optional, but then the criteria will be interpreted according to precedence rules.</p></div></li></ol></div><p class="docList">The reason that we want you to "start small" and add conditions is that it gives you a check on what you ought to get and it allows you to output less nonsense. Your minimal starting point should be a count of the join with appropriate join conditions.</P></div></LI><LI><div style="font-weight:normal"><p class="docList">Using the <tt>Student</tt> table, answer the following questions:</p><div style="font-weight:bold"><ol class="docList" type="a"><li><div style="font-weight:normal"><p class="docList">How many students have names like Smith?</p></div></li><li><div style="font-weight:normal"><p class="docList">How many have names that contain the letter sequence Smith?</p></div></li><li><div style="font-weight:normal"><p class="docList">How many student names end in LD?</p></div></li><li><div style="font-weight:normal"><p class="docList">How many student names start with S?</p></div></li><li><div style="font-weight:normal"><p class="docList">How many student names do not have "i" as the second letter?</p></div></LI><li><div style="font-weight:normal"><p class="docList">Would <tt>SELECT * FROM Student WHERE sname LIKE 'Smith%'</tt> find someone whose name is:</p><div style="font-weight:bold"><ol class="docList" type="i"><LI><div style="font-weight:normal"><p class="docList">LA SMITH</p></div></li><LI><div style="font-weight:normal"><p class="docList">SMITH-JONES</p></div></li><LI><div style="font-weight:normal"><p class="docList">SMITH JR.</p></div></LI><li><div style="font-weight:normal"><p class="docList">SMITH, JR</P></div></LI></ol></div></div></LI></ol></div></div></LI><li><div style="font-weight:normal"><p class="docList">Using the <tt>Course</tt> table, answer the following questions:</P><div style="font-weight:bold"><ol class="docList" type="a"><LI><div style="font-weight:normal"><p class="docList">List the junior-level COSC courses (LIKE COSC3xxx) and the name of the courses.</p></div></LI><LI><div style="font-weight:normal"><p class="docList">List all the courses except the junior-level COSC courses (use <tt>NOT LIKE</tt>).</p></div></li></ol></div></div></li><li><div style="font-weight:normal"><p class="docList">Using the <tt>COUNT</tt> feature, determine whether there are duplicate names or student numbers in the <tt>Student</tt> table.</P></div></li><li><div style="font-weight:normal"><p class="docList">Assume that all math courses start with <tt>MATH</tt>. How many math courses are there in the <tt>Section</tt> table? From the count of courses, does it appear that there any math courses in the <tt>Section</tt> table that are not in the <tt>Course</tt> table? Again, using <tt>COUNT</tt>s, are there any math courses in the <tt>Course</tt> table that are not in the <tt>Section</tt> table? Does it appear that there are any courses at all that are in the <tt>Grade_report</tt>, <tt>Section</tt>, or <tt>Course</tt> tables that are not in the others? (We will study how to ask these questions in SQL in a later chapter.) Note that a query like the following would not work:</P><pre>
    SELECT g.section_id
    FROM Grade_report g, Section t
    WHERE g.section_id &lt;&gt; t.section_id
</pre><BR>
<p class="docList">Explain why <tt>WHERE .. &lt;&gt; ..</tt> will not work to produce the desired output.</P></div></li><li><div style="font-weight:normal"><p class="docList">For every table in the <tt>Student_course</tt> database, we would like to compile the following information: attributes, number of rows, number of distinct rows, and rows without nulls. Find this information using different queries and compile the information in a table as shown here:</p><p><table cellspacing="0" border="1" RULES="all" cellpadding="4" width="90%"><colgroup span="5"><col><col><col><col><col></colgroup><thead><tr><th class="thead" scope="col" align="left"><p class="docText">Table</p></th><th class="thead" scope="col" align="left"><p class="docText">Attribute</p></th><th class="thead" scope="col" align="left"><p class="docText">Rows</p></th><th class="thead" scope="col" align="left"><p class="docText">Distinct Rows</p></th><th class="thead" scope="col" align="left"><p class="docText">Rows without Nulls</p></th></tr></thead><tr><td class="docTableCell" align="left"><p class="docText"><tt>Student</tt></p></td><TD class="docTableCell" align="left"><p class="docText"><tt>Stno</tt></p></td><TD class="docTableCell" align="left"><p class="docText">48</p></td><TD class="docTableCell" align="left"><p class="docText">48</p></td><TD class="docTableCell" align="left"><p class="docText">48</p></TD></tr><TR><TD class="docTableCell">&nbsp;</TD><TD class="docTableCell" align="left"><p class="docText"><tt>Sname</tt></p></TD><TD class="docTableCell" align="left"><p class="docText">48</p></TD><TD class="docTableCell" align="left"><p class="docText">47</p></td><td class="docTableCell" align="left"><p class="docText">48</p></TD></tr><tr><TD class="docTableCell">&nbsp;</TD><TD class="docTableCell" align="left"><p class="docText"><tt>Major</tt></p></td><td class="docTableCell" align="left"><p class="docText">48</p></td><td class="docTableCell" align="left"><p class="docText">8</p></td><td class="docTableCell">&nbsp;</td></tr><tr><td class="docTableCell">&nbsp;</td><td class="docTableCell" align="left"><p class="docText"><tt>Class</tt></P></td><td class="docTableCell" align="left"><p class="docText">etc.</P></td><td class="docTableCell" align="left"><p class="docText">etc.</P></td><td class="docTableCell" align="left"><p class="docText">etc.</P></td></TR><tr><TD class="docTableCell" align="left"><p class="docText"><tt>Section</tt></P></TD><TD class="docTableCell" align="left"><p class="docText"><tt>Section_id</tt></p></TD><TD class="docTableCell" align="left"><p class="docText">etc.</p></TD><TD class="docTableCell" align="left"><p class="docText">etc.</p></td><td class="docTableCell" align="left"><p class="docText">etc.</p></TD></tr></table></p><BR><p class="docList">The other tables in the <tt>Student_course</tt> database are <tt>Grade_report</tt>, <tt>Dependent</tt>, <tt>Section</tt>, <tt>Room</tt>, <tt>Course</tt>, <tt>Prereq</tt>, and <tt>Department_to_major</tt>.</P><p class="docList">Hint: You can use the following query:</P><pre>
    SELECT COUNT(*)
    FROM Student
    WHERE sname IS NULL
</pre><br>
</div></li><li><div style="font-weight:normal"><p class="docList">Find the count, sum, average, minimum, and maximum capacity of rooms in the database. Format the output using the <tt>STR</tt> function.</p><div style="font-weight:bold"><ol class="docList" type="a"><li><div style="font-weight:normal"><p class="docList">Where there is a null value for the capacity, assume the capacity to be 40, and find the average room size again.</p></div></li></ol></div></div></li><li><div style="font-weight:normal"><p class="docList">Using the <tt>Student</tt> table, display the first 10 rows with an appended initial. For the appended initial, choose the halfway letter of the name, so that if a name is Evans, the initial is A (half of the length +1). If the name is Conway, the initial is W (again, (half of the length +1)). You do not need to round up or down, just use <tt>(LEN(Name)/2)+1</tt> as the starting place to create the initial. Use appropriate column aliases. Your result should look like this (actual names may vary depending on the current database):</p><pre>
    PERSON#   NAMES
    --------- ------------------------
    1         Lineas, E.
    2         Mary, R.
    3         Brenda, N.
    4         Richard, H.
    5         Kelly, L.
    6         Lujack, A.
    7         Reva, V.
    8         Elainie, I.
    9         Harley, L.
    10        Donald, A.
</pre><br>
<div style="font-weight:bold"><ol class="docList" type="a"><li><div style="font-weight:normal"><p class="docList">Display the preceding output in all capital letters.</p></div></li></ol></div></div></li><LI><div style="font-weight:normal"><p class="docList">Find the names of the bottom 50 percent of the students, ordered by grade.</p><div style="font-weight:bold"><ol class="docList" type="a"><li><div style="font-weight:normal"><p class="docList">Find the names of the top 25 percent of the seniors, ordered by grade.</P></div></li><li><div style="font-weight:normal"><p class="docList">Now use the <tt>WITH TIES</tt> option with part (b). Is there any difference in the output?</P></div></li></ol></div></div></li><LI><div style="font-weight:normal"><p class="docList">Count the number of courses taught by each instructor.</p><div style="font-weight:bold"><ol class="docList" type="a"><LI><div style="font-weight:normal"><p class="docList">Count the number of distinct courses taught by each instructor.</p></div></LI></ol></div></div></LI><LI><div style="font-weight:normal"><p class="docList">Count the number of classes each student is taking.</P></div></li><LI><div style="font-weight:normal"><p class="docList">Display all the names that are less than five characters long from the <tt>Student</tt> table.</P></div></li><LI><div style="font-weight:normal"><p class="docList">List all the students with student numbers in the 140s range.</P></div></li><li><div style="font-weight:normal"><p class="docList">Find all the students (the student names should be listed only once) who received As and Bs.</p></div></li><LI><div style="font-weight:normal"><p class="docList">Would you call <tt>TOP</tt> an aggregate function? Why or why not?</p></div></li><LI><div style="font-weight:normal"><p class="docList">Add an asterisk (<tt>*</tt>) to the names of all juniors and seniors who received at least one A. (This question will take a few steps, and you will have to approach this problem in a step-by-step manner.)</P></div></LI><li><div style="font-weight:normal"><p class="docList">In this chapter, we used a table called <tt>Employee</tt>. Add a <tt>birthdate</tt> column and an <tt>employment_date</tt> column to the <tt>Employee</tt> table. Insert values into both the columns.</p><div style="font-weight:bold"><ol class="docList" type="a"><li><div style="font-weight:normal"><p class="docList">Display the current ages of all the employees.</p></div></li><li><div style="font-weight:normal"><p class="docList">Find the youngest employee.</p></div></li><li><div style="font-weight:normal"><p class="docList">Find the oldest employee.</p></div></li><li><div style="font-weight:normal"><p class="docList">Find the youngest employee at the time of employment.</p></div></li><li><div style="font-weight:normal"><p class="docList">Find the oldest employee at the time of employment.</P></div></li><li><div style="font-weight:normal"><p class="docList">Add five years to the current ages of all employees. Will any of the employees be over 65 in five years?</P></div></li><li><div style="font-weight:normal"><p class="docList">List the birth months and names of all employees.</P></div></li></ol></div></div></li></ol></div>

<a href="24991536.html"><img src="images/pixel.jpg" alt="" width="1" height="1" border="0"></a></TD></TR></table>
<br>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr><td><div STYLE="MARGIN-LEFT: 0.15in;">
<a href=learnsqlsvr05-CHP-5-SECT-8.html><img src="images/prev.gif" width="60" height="17" border="0" align="absmiddle" alt="Previous Page"></a>
<td align="right"><div STYLE="MARGIN-LEFT: 0.15in;">
<a href=learnsqlsvr05-CHP-6.html><img src="images/next.gif" width="60" height="17" border="0" align="absmiddle" alt="Next Page"></a>
</div></td></tr></table>
</body></html>